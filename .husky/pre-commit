#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

set -e

echo "ğŸš€ Running pre-commit checks..."

# Format staged files
echo "ğŸ§¹ Running lint-staged formatters..."
npx lint-staged
echo "âœ… Formatting complete!"

# Run ESLint (allow some warnings, block only errors)
echo "ğŸ” Running ESLint..."
npm run lint -- --max-warnings 25
echo "âœ… ESLint passed!"

# Run fast test sweep on changed files
echo "ğŸ§ª Running targeted tests..."
npm run test:changed -- --reporter=dot
echo "âœ… Tests passed!"

# TODO: Add TypeScript checks when Mapbox types are better defined
# For now, focus on ESLint to maintain code quality

echo "âœ… All checks passed! Ready to commit."
